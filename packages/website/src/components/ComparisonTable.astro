---
/**
 * Feature Comparison Table Component
 *
 * SMI-1158: Feature comparison table component
 *
 * A reusable component for displaying feature comparisons across tiers.
 * Used on pricing page and potentially other marketing pages.
 */

interface Feature {
  name: string
  community: string | boolean
  individual: string | boolean
  team: string | boolean
  enterprise: string | boolean
}

interface Props {
  features?: Feature[]
  highlightedTier?: 'community' | 'individual' | 'team' | 'enterprise'
  compact?: boolean
}

const {
  highlightedTier = 'team',
  compact = false,
  features = [
    {
      name: 'API Calls / Month',
      community: '1,000',
      individual: '10,000',
      team: '100,000',
      enterprise: 'Unlimited',
    },
    { name: 'License Keys', community: '1', individual: '3', team: '10', enterprise: '50' },
    { name: 'Skill Search', community: true, individual: true, team: true, enterprise: true },
    { name: 'Skill Installation', community: true, individual: true, team: true, enterprise: true },
    { name: 'Recommendations', community: true, individual: true, team: true, enterprise: true },
    {
      name: 'Analytics Dashboard',
      community: false,
      individual: 'Basic',
      team: 'Advanced',
      enterprise: 'Advanced',
    },
    { name: 'Team Workspaces', community: false, individual: false, team: true, enterprise: true },
    { name: 'Private Skills', community: false, individual: false, team: true, enterprise: true },
    { name: 'SSO / SAML', community: false, individual: false, team: false, enterprise: true },
    {
      name: 'Role-Based Access Control',
      community: false,
      individual: false,
      team: false,
      enterprise: true,
    },
    { name: 'Audit Logging', community: false, individual: false, team: false, enterprise: true },
    {
      name: 'SLA Guarantee',
      community: false,
      individual: false,
      team: false,
      enterprise: '99.9%',
    },
    {
      name: 'Support',
      community: 'Community',
      individual: 'Email',
      team: 'Priority',
      enterprise: 'Dedicated',
    },
  ],
} = Astro.props

const tiers = ['community', 'individual', 'team', 'enterprise'] as const

function renderValue(value: string | boolean): string {
  if (value === true) {
    return '<span class="check" aria-label="Yes">&#10003;</span>'
  }
  if (value === false) {
    return '<span class="dash" aria-label="No">&mdash;</span>'
  }
  return value
}
---

<div class="comparison-table-wrapper">
  <table class:list={['comparison-table', { compact }]}>
    <thead>
      <tr>
        <th>Feature</th>
        {
          tiers.map((tier) => (
            <th class:list={{ highlighted: tier === highlightedTier }}>
              {tier.charAt(0).toUpperCase() + tier.slice(1)}
            </th>
          ))
        }
      </tr>
    </thead>
    <tbody>
      {
        features.map((feature) => (
          <tr>
            <td>{feature.name}</td>
            {tiers.map((tier) => (
              <td
                class:list={{ highlighted: tier === highlightedTier }}
                set:html={renderValue(feature[tier])}
              />
            ))}
          </tr>
        ))
      }
    </tbody>
  </table>
</div>

<style>
  .comparison-table-wrapper {
    overflow-x: auto;
    border-radius: 1rem;
    border: 1px solid #2a2a2f;
    background: #121214;
  }

  .comparison-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.875rem;
  }

  .comparison-table.compact {
    font-size: 0.8125rem;
  }

  .comparison-table th,
  .comparison-table td {
    padding: 1rem 1.5rem;
    text-align: center;
    border-bottom: 1px solid #2a2a2f;
  }

  .comparison-table.compact th,
  .comparison-table.compact td {
    padding: 0.75rem 1rem;
  }

  .comparison-table th:first-child,
  .comparison-table td:first-child {
    text-align: left;
    font-weight: 500;
  }

  .comparison-table thead th {
    background: #1a1a1f;
    font-weight: 600;
    color: #fafafa;
  }

  .comparison-table th.highlighted,
  .comparison-table td.highlighted {
    background: rgba(224, 122, 95, 0.05);
  }

  .comparison-table thead th.highlighted {
    background: rgba(224, 122, 95, 0.1);
    color: #e07a5f;
  }

  .comparison-table tbody tr:last-child td {
    border-bottom: none;
  }

  .comparison-table tbody tr:hover {
    background: rgba(255, 255, 255, 0.02);
  }

  .comparison-table :global(.check) {
    color: #10b981;
    font-weight: 700;
    font-size: 1rem;
  }

  .comparison-table :global(.dash) {
    color: #4a4a4f;
  }

  @media (max-width: 768px) {
    .comparison-table th,
    .comparison-table td {
      padding: 0.75rem 0.5rem;
      font-size: 0.75rem;
    }

    .comparison-table th:first-child,
    .comparison-table td:first-child {
      min-width: 120px;
    }
  }
</style>
